#include "StartStop.h"


/* Esta tarea se ejecuta siempre que se produzca un cruce por cero.*/
static void vHandlerStart(void *pvParameters){

	/* Se toma el semaforo para vaciarlo antes de entrar al loop infinito */
    xSemaphoreTake(xPhaseSemaphore, (portTickType) 0);

	while (1) {

		/* La tarea permanece bloqueada hasta que el semaforo se libera */
        xSemaphoreTake(xPhaseSemaphore, portMAX_DELAY);

        cycles_count++;		//Se cuenta un nuevo ciclo de la senoidal

        /* Se configura el valor maximo del timer */
        Chip_TIMER_SetMatch(FIRE_TRIGGER_TIMER, FIRE_TRIGGER_CHANNEL,controller_output);//TIMER_BASE+TIMER_STEP*adc_data);
        /* Se habilita el timer para disparar el trigger */
        Chip_TIMER_Enable(FIRE_TRIGGER_TIMER);
    }
}
